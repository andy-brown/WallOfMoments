<!DOCTYPE html>
<html>
    <head>
        <title>Wall of Moments</title>
        <link rel="stylesheet" href="style.css">
    </head>

    <body>
        <div id='montage'></div>

<script>
    // define size of montage area
    var width = 960, height = 540;

    // define source material
    var vidPath = 'videos/';
    var vids = ['autumnwatch.mp4', 'philharmonic.webm',
        '4-News-ch-greece-2.webm', 'autumnwatch.mp4'];

    // work out positions
    var x = [0, 0.5, 0, 0.5];
    var y = [0,0,0.5,0.5];
    var cropA = {w:width/4, h:height/4, x:width/4, y:height/4};
    var cropB = {w:(3*width)/8, h:(3*height/8), x:width/8, y:height/8};
    var crops = [cropB, null, cropA, null];
    var placements = [];
    for(var i=0; i<vids.length; i++){
        var pos = {
            w:width/2,
            h:height/2,
            x: width*x[i],
            y: height*y[i]
        }
        placements.push(pos);
    }

    // add videos
    var vidElements = [];
    for(var i=0; i<vids.length; i++){
        var t = addVideoStream("vid" + i, vidPath + vids[i], placements[i], crops[i]);
        vidElements.push(t);
        // t.play();
    }

    // Add a video sream to the montage
    // at specified postion with (optional) cropping
    function addVideoStream(vidid, vid, pos, crop){

        var vidEl = document.createElement('video');
        vidEl.width = pos.w;
        vidEl.height = pos.h;
        vidEl.id = vidid;

        var cropEl = document.createElement('div');
        cropEl.className = 'crop';
        cropEl.style.top = pos.y + "px";
        cropEl.style.left = pos.x + "px";

        cropEl.appendChild(vidEl);
        if (crop != null){
            cropEl.style.width = pos.w;
            cropEl.style.height = pos.h;
            vidEl.style.marginLeft = -crop.x + "px";
            vidEl.style.marginTop = -crop.y + "px";
            vidEl.width = pos.w * (pos.w/crop.w);
            vidEl.height = pos.h * (pos.h/crop.h);
        }

        // vidEl.controls = true;
        vidEl.src = vid;
        vidEl.autoplay = true;

        var container = document.getElementById('montage');
        container.appendChild(cropEl);
        return vidEl;
    }


    /****
    play, pause, skip, replace individual streams
    ****/
    function play(streamNo){
        var videl = vidElements[streamNo];
        videl.play();
    }

    function pause(streamNo){
        var videl = vidElements[streamNo];
        videl.pause();
    }

    function skipTo(streamNo, time){
        var videl = vidElements[streamNo];
        videl.currentTime = time;
    }

    function replace(streamNo, path){
        var videl = vidElements[streamNo];
        videl.src = path;
    }


</script>
</body>
</html>
