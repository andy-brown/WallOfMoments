<!DOCTYPE html>
<html>
    <head>
        <title>Wall of Moments</title>
        <link rel="stylesheet" href="style.css">
    </head>

    <body>
        <div id='montage'></div>

<script>
    // define size of montage area
    var width = 960, height = 540;

    // define source material
    var vidPath = 'videos/';
    var vids = ['autumnwatch.mp4', 'philharmonic.webm',
        '4-News-ch-greece-2.webm', 'autumnwatch.mp4'];

    // work out positions
    var x = [0, 0.5, 0, 0.5];
    var y = [0,0,0.5,0.5];
    var cropA = {width:width/4, height:height/4, left:width/4, top:height/4};
    var cropB = {width:(3*width)/8, height:(3*height/8), left:width/8, top:height/8};
    var crops = [cropB, null, cropA, null];
    var placements = [];
    for(var i=0; i<vids.length; i++){
        var pos = {
            width:width/2,
            height:height/2,
            left: width*x[i],
            top: height*y[i]
        }
        placements.push(pos);
    }

    // add videos
    var vidElements = [];
    for(var i=0; i<vids.length; i++){
        var t = addVideoStream("vid" + i, vidPath + vids[i], placements[i], crops[i]);
        vidElements.push(t);
        // t.play();
    }

    // Add a video sream to the montage
    // at specified postion with (optional) cropping
    function addVideoStream(vidid, vid, pos, crop){

        var vidEl = document.createElement('video');
        vidEl.width = pos.width;
        vidEl.height = pos.height;
        vidEl.id = vidid;

        var cropEl = document.createElement('div');
        cropEl.className = 'crop';
        cropEl.style.top = pos.top + "px";
        cropEl.style.left = pos.left + "px";

        cropEl.appendChild(vidEl);
        if (crop != null){
            cropEl.style.width = pos.width;
            cropEl.style.height = pos.height;
            vidEl.style.marginLeft = -crop.left + "px";
            vidEl.style.marginTop = -crop.top + "px";
            vidEl.width = pos.width * (pos.width/crop.width);
            vidEl.height = pos.height * (pos.height/crop.height);
        }

        // vidEl.controls = true;
        vidEl.src = vid;
        vidEl.autoplay = true;

        var container = document.getElementById('montage');
        container.appendChild(cropEl);
        return vidEl;
    }


    /****
    play, pause, skip, replace individual streams
    ****/
    function play(streamNo){
        var videl = vidElements[streamNo];
        videl.play();
    }

    function pause(streamNo){
        var videl = vidElements[streamNo];
        videl.pause();
    }

    function skipTo(streamNo, time){
        var videl = vidElements[streamNo];
        videl.currentTime = time;
    }

    function replace(streamNo, path){
        var videl = vidElements[streamNo];
        videl.src = path;
    }


</script>
</body>
</html>
